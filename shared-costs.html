<!DOCTYPE html>
<html lang="">
	<head>
		<meta charset="utf-8">
		<title>Shared Expenses</title>

		<!-- Bootstrap CSS -->
		<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">

		<style type="text/css">
			body {
				background: #B7E1CE;
				text-align: center;
			}
			body {
				margin: 100px;
			}
		</style>
	</head>

	<body>
		<h2>SHARED EXPENSES</h2>

		<form action="calculate" method="post" id="user_inputs">
			<p>Roommate 1 has already paid: <input type="number" name="Roommate 1" /></p>
		    <p>Roommate 2 has already paid: <input type="number" name="Roommate 2" /></p>
		    <p>Roommate 3 has already paid: <input type="number" name="Roommate 3" /></p>
		</form>
		<input type="submit" name="submit" value="Calculate" onClick="displayPayments();"/>
		
		<hr>
		<div id="finalTotals"></div>

        <!-- jQuery -->
		<script src="https://code.jquery.com/jquery.js"></script>
		<!-- Bootstrap JavaScript -->
		<script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

		<script type"text/javascript">

			function getInputs() {
				// get all inputs into an array
				var $inputs = $('#user_inputs :input');

				// get an associative array of just the values
				var values = {};
				$inputs.each(function() {
				    values[this.name] = $(this).val()/1;
				});

				return values;				
			}

			function getAveragePaid(currentPayments) {
				var sum = 0;
				var count = 0;

				$.each(currentPayments, function(key, value) {
					sum += value;
					count += 1;
				});

				return sum/count;
			}

			function getFinalPayments(currentPayments) {
				var averagePaid = getAveragePaid(currentPayments);
				var finalPayments = {};

				$.each(currentPayments, function(key, value) {
					var finalPaymentAmount = averagePaid-currentPayments[key];
					finalPayments[key] = finalPaymentAmount;
				});

				return finalPayments;
			}

			function displayPayments() {
				var currentPayments = getInputs();
				var finalPayments = getFinalPayments(currentPayments);

				$('#finalTotals').empty();

				var finalTotals = "";

				$.each(finalPayments, function(key, value) {
					finalTotals += "<p>" + key + " pays: $" + value + "</p>"; 
				});

				document.getElementById('finalTotals').innerHTML = finalTotals;
			}

		</script>
	</body>
</html>